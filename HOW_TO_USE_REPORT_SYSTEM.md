# 📚 通報システムの使い方ガイド

## 🚀 システムを起動する

### 1. 開発サーバーを起動

ターミナルを開いて、以下のコマンドを実行します：

```bash
cd /Users/muraokadaichi/WEEK４勉強/secure-session-system
npm run dev
```

サーバーが起動したら、以下のメッセージが表示されます：
```
▲ Next.js 14.x.x
- Local:        http://localhost:3000
✓ Ready
```

---

## 🌐 管理画面にアクセスする

### 1. ブラウザを開く
Google Chrome、Safari、Firefox などのブラウザを開いてください。

### 2. 管理画面にアクセス
アドレスバーに以下のURLを入力してEnterキーを押します：

```
http://localhost:3000/admin/reports
```

---

## 📊 通報一覧画面の使い方

### 画面の見方

#### 統計カード（上部）
- 🟡 **未処理**: まだ確認していない通報（現在: 119件）
- 🔵 **レビュー中**: 確認作業中の通報（現在: 62件）  
- 🟢 **解決済み**: 対応完了した通報（現在: 54件）
- ⚪ **合計**: すべての通報数（現在: 235件）

#### フィルター機能（中央）
通報を絞り込んで表示できます：

1. **ステータスで絞り込み**
   - すべて
   - 未処理
   - レビュー中
   - 承認済み
   - 却下済み
   - 解決済み

2. **優先度で絞り込み**
   - すべて
   - 🔴 緊急
   - 🟠 高
   - 🟡 中
   - 🟢 低

3. **種類で絞り込み**
   - すべて
   - 投稿
   - ユーザー
   - コメント

4. **更新ボタン**
   最新のデータを取得します

#### 通報リスト（下部）
各通報の情報が表として表示されます：
- **種類**: アイコンで表示（📄投稿、👤ユーザー、💬コメント）
- **理由**: 通報理由と詳細
- **通報者**: 通報した人の名前とメールアドレス
- **ステータス**: 現在の処理状況
- **優先度**: 対応の緊急度
- **作成日時**: 通報された日時
- **アクション**: 実行できる操作ボタン

---

## 🔍 通報を詳しく見る・処理する

### 1. 詳細を表示する
通報リストの右端にある **👁️ アイコン**をクリック

### 2. 通報詳細画面の構成

#### 左側：メインエリア
- **通報内容**: 理由と詳細説明
- **対象コンテンツ**: 通報された投稿やコメントの内容
- **対象ユーザー情報**: 
  - 名前とメールアドレス
  - 現在の状態（アクティブ/停止中/BAN）
  - 警告回数
  - 「ユーザー詳細を表示」ボタン
- **内部メモ**: 管理者間での申し送り事項

#### 右側：サイドバー
- **アクションボタン**:
  - 「自分にアサイン」: この通報の担当になる
  - 「承認する」: 通報を正当と判断
  - 「却下する」: 通報を不当と判断
- **通報者情報**: 通報した人の情報
- **タイムライン**: 処理の履歴
- **関連する通報**: 同じ対象への他の通報

---

## 🎯 通報を処理する

### 承認する場合

1. **「承認する」ボタンをクリック**

2. **処置内容を選択**
   - ⚠️ 警告を発行: 違反者に警告メールを送信
   - 🗑️ コンテンツを削除: 投稿やコメントを削除
   - 🔒 ユーザーを停止: アカウントを一時停止
   - ⛔ ユーザーをBAN: アカウントを永久停止
   - ✅ 対応なし: 記録のみ残す

3. **処理メモを記入**（任意）
   なぜこの処置を選んだか記録できます

4. **「確定」ボタンをクリック**
   - 違反者に警告メールが自動送信されます
   - 通報者に処理完了メールが自動送信されます

### 却下する場合

1. **「却下する」ボタンをクリック**

2. **処理メモを記入**（任意）
   却下理由を記録できます

3. **「確定」ボタンをクリック**
   - 通報者に処理完了メールが自動送信されます

---

## 📝 内部メモを追加する

管理者間で情報共有するための機能です：

1. **「メモを追加」ボタンをクリック**
2. **メモ内容を入力**
3. **「追加」ボタンをクリック**

メモは削除できないので、慎重に記入してください。

---

## 🔄 ページ操作

### ページネーション
通報リストの下部で操作できます：
- **表示件数の変更**: 25件、50件、100件から選択
- **ページ移動**: < > ボタンでページを切り替え

### データの更新
- **「更新」ボタン**: 最新のデータを取得
- **自動更新はされません**: 定期的に更新ボタンを押してください

---

## ⚡ クイックアクション

通報一覧画面から素早く処理できます：

### 未処理の通報の場合
- ✅ **緑のチェックマーク**: 承認（警告発行）
- ❌ **赤のバツマーク**: 却下

クリックすると確認ダイアログが表示されます。

---

## 🚨 注意事項

### メール送信について
- **警告メール**: 違反者のメールアドレスに送信されます
- **通知メール**: 管理者用メールアドレスに送信されます
- **完了通知**: 通報者のメールアドレスに送信されます

### データの取り扱い
- **個人情報**: ユーザーのメールアドレスや名前が表示されます
- **削除不可**: 一度作成された通報は削除できません
- **監査ログ**: すべての操作が記録されます

### 処理の優先順位
1. 🔴 **緊急（Critical）**: 即座に対応
2. 🟠 **高（High）**: 早急に対応
3. 🟡 **中（Medium）**: 通常対応
4. 🟢 **低（Low）**: 時間があるときに対応

---

## 💡 便利な使い方

### 効率的な処理フロー

1. **優先度でフィルター**
   「緊急」や「高」でフィルターして重要な通報から処理

2. **ステータスでフィルター**
   「未処理」でフィルターして新しい通報を確認

3. **一括確認**
   同じユーザーへの複数の通報は、詳細画面の「関連する通報」で確認

4. **メモ活用**
   判断に迷う場合は、メモに記録して他の管理者と相談

---

## 🆘 トラブルシューティング

### 画面が表示されない
```bash
# サーバーを再起動
npm run dev
```

### データが更新されない
- ブラウザの更新ボタン（F5キー）を押す
- 画面の「更新」ボタンをクリック

### メールが送信されない
- `.env.local`ファイルのメール設定を確認
- インターネット接続を確認

### エラーが表示される
- ブラウザのコンソール（F12キー）でエラー内容を確認
- サーバーのターミナルでエラーログを確認

---

## 📞 テスト環境での注意

現在は**テスト環境**で動作しています：
- メールは実際には送信されません（ログに記録）
- データはテスト用のダミーデータです
- 本番環境とは異なる設定になっています

---

## 🎯 実際に試してみましょう！

1. **ブラウザで管理画面を開く**
   ```
   http://localhost:3000/admin/reports
   ```

2. **未処理の通報を1件選んで詳細を見る**

3. **「承認する」または「却下する」を試す**

4. **フィルター機能を使って絞り込む**

5. **内部メモを追加してみる**

これで通報システムの基本的な使い方は完了です！
質問があれば、お気軽にお尋ねください。