# 通報システム完全ガイド - 非エンジニア向け説明書

## 📌 はじめに

このドキュメントは、Webサービスの「通報システム」について、プログラミングの知識がない方でも理解できるように説明したものです。通報システムは、ユーザーが不適切なコンテンツや迷惑行為を運営側に報告するための重要な機能です。

---

## 🏗️ システムの全体構造

### フォルダ構成（ディレクトリ構造）

システムは以下のようなフォルダ構成になっています。各フォルダは「引き出し」のようなもので、関連するファイルが整理されて保管されています。

```
secure-session-system/
│
├── 📁 models/                    【データの設計図を保管】
│   └── Report.js                  通報データの構造を定義
│
├── 📁 lib/                        【共通で使う機能を保管】
│   └── email.ts                   メール送信機能
│
├── 📁 app/
│   ├── 📁 api/                    【サーバー側の処理を保管】
│   │   └── 📁 admin/
│   │       └── 📁 reports/
│   │           ├── route.ts       通報の作成・取得・更新処理
│   │           └── 📁 [id]/
│   │               └── route.ts   特定の通報の詳細取得処理
│   │
│   └── 📁 admin/                  【管理画面を保管】
│       └── 📁 reports/
│           ├── page.tsx           通報一覧画面
│           └── 📁 [id]/
│               └── page.tsx       通報詳細画面
```

---

## 📊 データベース構造（データの保管方法）

### 通報データに保存される情報

通報システムでは、以下の情報をデータベース（情報の倉庫）に保存します：

#### 1. **基本情報**
- **通報タイプ**: 投稿への通報、ユーザーへの通報、コメントへの通報
- **通報対象**: 誰の・何に対する通報か
- **通報者**: 誰が通報したか

#### 2. **通報理由**
- **スパム**: 迷惑な広告や繰り返し投稿
- **ハラスメント**: いじめや嫌がらせ
- **不適切なコンテンツ**: 不適切な画像や文章
- **ヘイトスピーチ**: 差別的な発言
- **暴力的な内容**: 暴力を含む内容
- **誤情報**: 虚偽の情報
- **著作権侵害**: 他人の作品の無断使用
- **その他**: 上記以外の理由

#### 3. **優先度**（自動判定される）
- 🔴 **緊急（Critical）**: 即座に対応が必要
- 🟠 **高（High）**: 早急な対応が必要
- 🟡 **中（Medium）**: 通常の対応
- 🟢 **低（Low）**: 時間があるときに対応

#### 4. **ステータス**（処理状況）
- **未処理（Pending）**: まだ確認されていない
- **レビュー中（Reviewing）**: 管理者が確認中
- **承認済み（Approved）**: 通報が正当と判断された
- **却下済み（Rejected）**: 通報が不当と判断された
- **解決済み（Resolved）**: 対応が完了した

---

## 🔄 通報の流れ（3ステップフロー）

### ステップ1: ユーザーが通報する
1. ユーザーが不適切なコンテンツを発見
2. 「通報する」ボタンをクリック
3. 通報理由を選択
4. 詳細を記入（任意）
5. 送信

### ステップ2: 管理者が確認する
1. 管理画面に通報が表示される
2. 管理者にメール通知が送られる
3. 管理者が内容を確認
4. 優先度に応じて対応順序を決定

### ステップ3: 対応を実施する
1. 管理者が対応方法を選択：
   - ⚠️ 警告を発行
   - 🗑️ コンテンツを削除
   - 🔒 ユーザーを一時停止
   - ⛔ ユーザーを永久停止
   - ✅ 対応なし（通報を却下）

2. 通報者と違反者にメール通知が送られる

---

## 💻 画面の説明

### 1. 通報一覧画面（管理者用）

管理者が全ての通報を確認できる画面です。

#### 表示される情報：
- **統計カード**: 未処理、レビュー中、解決済みの件数
- **フィルター機能**: ステータス、優先度、種類で絞り込み
- **通報リスト**: 通報の一覧表

#### できること：
- 通報の詳細を見る
- クイックアクション（すぐに承認・却下）
- 更新ボタンで最新情報を取得

### 2. 通報詳細画面（管理者用）

特定の通報の詳細情報を確認し、対応を行う画面です。

#### 表示される情報：
- **通報内容**: 理由、詳細、対象コンテンツ
- **対象ユーザー情報**: 名前、メール、警告回数、アカウント状態
- **通報者情報**: 通報した人の基本情報
- **タイムライン**: いつ誰が何をしたかの履歴
- **関連する通報**: 同じ対象への他の通報
- **内部メモ**: 管理者間の申し送り事項

#### できるアクション：
- 自分にアサイン（担当になる）
- 通報を承認する
- 通報を却下する
- 内部メモを追加する

---

## 📧 メール通知システム

### 送信されるメールの種類

#### 1. **管理者向け通報通知**
- **いつ送られる**: 新しい通報があったとき
- **内容**: 通報タイプ、理由、通報者名、対象コンテンツの一部
- **目的**: 迅速な対応を促す

#### 2. **通報者向け処理完了通知**
- **いつ送られる**: 通報が処理されたとき
- **内容**: 
  - 承認の場合：「適切な措置を講じました」
  - 却下の場合：「現時点では対応の必要はないと判断しました」
- **目的**: 通報者に結果を知らせる

#### 3. **違反者向け警告メール**
- **いつ送られる**: 警告が発行されたとき
- **内容**: 警告理由、警告回数、今後の注意事項
- **目的**: 行動改善を促す

---

## 🛡️ セキュリティ機能

### 1. 虚偽通報の検出
- 同じユーザーが同じ対象を何度も通報できない仕組み
- 通報履歴の追跡
- IPアドレスの記録

### 2. 権限管理
- 管理者のみが通報を確認・処理できる
- 全ての操作が監査ログに記録される
- 秘密キーによるアクセス制御

### 3. 警告システム
- 警告回数の自動カウント
- 3回以上の警告で自動的にアカウント停止を検討
- 段階的な処罰システム

---

## 📈 統計とレポート機能

### 確認できる統計情報

1. **ステータス別件数**
   - 未処理の通報数
   - レビュー中の通報数
   - 解決済みの通報数

2. **優先度別の分布**
   - 緊急対応が必要な件数
   - 各優先度の割合

3. **通報理由の傾向**
   - どの理由での通報が多いか
   - 時系列での変化

---

## 🎯 優先順位の自動判定ロジック

システムは以下の基準で優先度を自動的に判定します：

### 緊急（Critical）になる条件：
- 暴力的な内容
- ヘイトスピーチ
- 同一対象への複数の通報

### 高（High）になる条件：
- ハラスメント
- 不適切なコンテンツ
- 警告回数が多いユーザーへの通報

### 中（Medium）になる条件：
- スパム
- 誤情報
- 通常の規約違反

### 低（Low）になる条件：
- その他の理由
- 初回の軽微な違反

---

## ⚙️ システムの技術的な仕組み（簡単に）

### 使用している主な技術

1. **Next.js**: Webサイトを作るフレームワーク（土台）
2. **TypeScript**: プログラミング言語（より安全なJavaScript）
3. **MongoDB**: データベース（情報を保管する倉庫）
4. **Material UI**: デザインシステム（見た目を整える道具）
5. **Nodemailer**: メール送信システム

### データの流れ

```
ユーザー → ブラウザ → サーバー → データベース
         ↑                    ↓
         ← メール通知 ← 処理結果
```

---

## 🚀 今後の改善ポイント

1. **AI による自動判定**: 通報内容を AI が分析して優先度を判定
2. **画像認識**: 不適切な画像を自動検出
3. **レポート生成**: 定期的な統計レポートの自動作成
4. **多言語対応**: 複数言語での通報受付
5. **通報者の信頼度スコア**: 正確な通報を行うユーザーの通報を優先

---

## 📝 よくある質問（FAQ）

### Q1: 通報したら相手にバレますか？
**A**: いいえ、通報者の情報は管理者のみが確認でき、違反者には通知されません。

### Q2: 間違えて通報してしまった場合は？
**A**: 管理者が内容を確認して判断するので、間違いであれば却下されます。通報者にペナルティはありません。

### Q3: どのくらいで対応されますか？
**A**: 優先度により異なりますが、緊急の場合は即座に、通常は24時間以内の対応を目指しています。

### Q4: 警告を受けたらどうなりますか？
**A**: 1-2回の警告は注意喚起です。3回以上でアカウント停止の可能性があります。

### Q5: 通報が却下されたら？
**A**: 内容を再検討し、必要であれば詳細を追加して再度通報することができます。

---

## 🔧 トラブルシューティング

### 問題: 通報ボタンが反応しない
**解決策**: ブラウザを更新するか、キャッシュをクリアしてください。

### 問題: メール通知が届かない
**解決策**: 迷惑メールフォルダを確認し、noreply@miraichimoonshot.sakura.ne.jp を受信許可リストに追加してください。

### 問題: 通報一覧が表示されない
**解決策**: 管理者権限があることを確認し、ログインし直してください。

---

## 📞 サポート

ご不明な点がございましたら、以下までお問い合わせください：

- **技術的な問題**: システム管理者まで
- **通報内容について**: コミュニティ管理チームまで
- **その他のお問い合わせ**: サポートセンターまで

---

*このドキュメントは定期的に更新されます。最終更新日: 2024年*